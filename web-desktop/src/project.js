require=function r(i,a,s){function h(t,e){if(!a[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(d)return d(t,!0);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}var o=a[t]={exports:{}};i[t][0].call(o.exports,function(e){return h(i[t][1][e]||e)},o,o.exports,r,i,a,s)}return a[t].exports}for(var d="function"==typeof require&&require,e=0;e<s.length;e++)h(s[e]);return h}({backgroundLoader:[function(e,t,n){"use strict";cc._RF.push(t,"1ba569pWT1NW4FvgybtQ/YJ","backgroundLoader"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var e="bg"+((100*Math.random()|0)%3+1),n=this.node.getComponent(cc.Sprite);cc.loader.loadRes("hero/"+e,cc.SpriteFrame,function(e,t){n.spriteFrame=t}),cc.log(e)}}),cc._RF.pop()},{}],btn:[function(e,t,n){"use strict";cc._RF.push(t,"2da0dBTR9tDEoDKa8CshNX4","btn");var c=e("landMaker");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},buttonClicked:function(){c.restart()},gameStart:function(){cc.director.loadScene("MainGameScene")}}),cc._RF.pop()},{landMaker:"landMaker"}],landMaker:[function(e,t,n){"use strict";cc._RF.push(t,"d0079DKriBNl693joESFHLy","landMaker");var c=e("spriteCreator"),o=e("perfectLabel"),r=e("storageManager"),i=new StateMachine({data:{gameDirector:null},init:"stand",transitions:[{name:"stickLengthen",from:"stand",to:"stickLengthened"},{name:"heroTick",from:"stickLengthened",to:"heroTicked"},{name:"stickFall",from:"heroTicked",to:"stickFalled"},{name:"heroMoveToLand",from:"stickFalled",to:"heroMovedToLand"},{name:"landMove",from:"heroMovedToLand",to:"stand"},{name:"heroMoveToStickEnd",from:"stickFalled",to:"heroMovedToStickEnd"},{name:"heroDown",from:"heroMovedToStickEnd",to:"heroDowned"},{name:"gameOver",from:"heroDowned",to:"end"},{name:"restart",from:"end",to:"stand"}],methods:{onLeaveHeroTicked:function(){a.unregisterEvent()},onStickLengthen:function(){a.stickLengthen=!0,a.stick=a.createStick(),a.stick.x=a.hero.x+a.hero.width*(1-a.hero.anchorX)+a.stick.width*a.stick.anchorX,a.hero.getComponent(cc.Animation).play("heroPush")},onHeroTick:function(){a.stickLengthen=!1,a.hero.getComponent(cc.Animation).play("heroTick")},onStickFall:function(){var e=cc.rotateBy(.5,90);e.easing(cc.easeIn(3));var t=cc.callFunc(function(){var e=a.stick.height-a.stick.width*a.stick.anchorX;e<a.currentLandRange||e>a.currentLandRange+a.secondLand.width?i.heroMoveToStickEnd():(i.heroMoveToLand(),e>a.currentLandRange+a.secondLand.width/2-5&&e<a.currentLandRange+a.secondLand.width/2+5?(a.perfect++,a.getScore(a.perfect),a.perfectLabel.getComponent(o).showPerfect(a.perfect)):a.perfect=0)}),n=cc.sequence(e,t);a.stick.runAction(n)},onHeroMoveToLand:function(){var e=a.hero.getComponent(cc.Animation),t=cc.callFunc(function(){e.stop("heroRun"),a.getScore(),i.landMove()});e.play("heroRun"),a.heroMove(a.hero,{length:a.currentLandRange+a.secondLand.width,callFunc:t})},onLandMove:function(){var e=cc.callFunc(function(){a.registerEvent()});a.landCreateAndMove(e)},onHeroMoveToStickEnd:function(){var e=a.hero.getComponent(cc.Animation),t=cc.callFunc(function(){e.stop("heroRun"),i.heroDown()});e.play("heroRun"),a.heroMove(a.hero,{length:a.stick.height,callFunc:t})},onHeroDown:function(){var e=cc.callFunc(function(){i.gameOver()});a.stickAndHeroDownAction(e)},onGameOver:function(){a.overLabel.node.active=!0},onRestart:function(){cc.director.loadScene("MainGameScene")}}}),a=null;cc.Class({extends:cc.Component,properties:{landRange:cc.v2(20,300),landWidth:cc.v2(20,200),hero:cc.Node,firstLand:cc.Node,secondLand:cc.Node,moveDuration:.5,stickSpeed:400,heroMoveSpeed:400,stickWidth:6,canvas:cc.Node,scoreLabel:cc.Label,hightestScoreLabel:cc.Label,overLabel:cc.Label,perfectLabel:cc.Node},onLoad:function(){(a=this).runLength=0,this.stick=null,this.stickLengthen=!1,this.score=0,this.perfect=0,this.currentLandRange=0,this.heroWorldPosX=0,this.changeHightestScoreLabel(),this.createNewLand();var e=this.getLandRange();this.heroWorldPosX=this.firstLand.width-(1-this.hero.anchorX)*this.hero.width-this.stickWidth,this.secondLand.setPosition(e+this.firstLand.width,0),this.registerEvent(),a.hero.getComponent(cc.Animation).on("stop",function(e){"heroTick"==e.target.name&&i.stickFall()})},registerEvent:function(){this.canvas.on(cc.Node.EventType.TOUCH_START,this.touchStart.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel.bind(this),this.node),console.log("on")},unregisterEvent:function(){this.canvas.targetOff(this.node),console.log("off")},update:function(e){this.stickLengthen&&(this.stick.height+=e*this.stickSpeed)},touchStart:function(e){i.stickLengthen(),cc.log("touchStart")},touchEnd:function(e){i.heroTick(),cc.log("touchEnd")},touchCancel:function(){this.touchEnd(),cc.log("touchCancel")},stickAndHeroDownAction:function(e){var t=cc.rotateBy(.5,90);t.easing(cc.easeIn(3)),this.stick.runAction(t);var n=cc.moveBy(.5,cc.p(0,-300-this.hero.height));n.easing(cc.easeIn(3));var c=cc.sequence(n,e);this.hero.runAction(c)},heroMove:function(e,t){var n=t.length/this.heroMoveSpeed,c=cc.moveBy(n,cc.p(t.length,0));if(t.callFunc){var o=cc.sequence(c,t.callFunc);this.hero.runAction(o)}else this.hero.runAction(c)},landCreateAndMove:function(e){var t=cc.director.getWinSize(),n=this.currentLandRange+this.secondLand.width;this.runLength+=n;var c=cc.moveBy(this.moveDuration,cc.p(-n,0));this.node.runAction(c),this.firstLand=this.secondLand,this.createNewLand();var o=this.getLandRange();this.secondLand.setPosition(this.runLength+t.width,0);var r=t.width-o-this.heroWorldPosX-this.hero.width*this.hero.anchorX-this.stickWidth,i=cc.moveBy(this.moveDuration,cc.p(-r,0)),a=cc.sequence(i,e);this.secondLand.runAction(a)},createStick:function(){cc.log("sc");var e=c.createStick(this.stickWidth);return e.parent=this.node,e},createNewLand:function(){this.secondLand=c.createNewLand(this.getLandWidth()),this.secondLand.parent=this.node},getScore:function(e){e?this.score+=e:this.score++,r.getHighestScore()<this.score&&(r.setHighestScore(this.score),this.changeHightestScoreLabel()),this.scoreLabel.string="得分:"+this.score},changeHightestScoreLabel:function(){this.hightestScoreLabel.string="最高分:"+r.getHighestScore()},getLandRange:function(){this.currentLandRange=this.landRange.x+(this.landRange.y-this.landRange.x)*Math.random();var e=cc.director.getWinSize();return e.width<this.currentLandRange+this.heroWorldPosX+this.hero.width+this.secondLand.width&&(this.currentLandRange=e.width-this.heroWorldPosX-this.hero.width-this.secondLand.width),this.currentLandRange},getLandWidth:function(){return this.landWidth.x+(this.landWidth.y-this.landWidth.x)*Math.random()}}),t.exports=i,cc._RF.pop()},{perfectLabel:"perfectLabel",spriteCreator:"spriteCreator",storageManager:"storageManager"}],perfectLabel:[function(e,t,n){"use strict";cc._RF.push(t,"68d3cmKQRxMxJwM5MfqZrPh","perfectLabel"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.label=this.node.getComponent(cc.Label)},showPerfect:function(e){this.label.string="Perfect x"+e;var t=cc.fadeIn(.1),n=cc.moveBy(1,cc.p(0,0)),c=cc.fadeOut(0),o=cc.sequence(t,n,c);this.node.runAction(o)},removeLabel:function(){cc.log("removeLabel")},showLabel:function(){cc.log("showLabel")}}),cc._RF.pop()},{}],spriteCreator:[function(e,t,n){"use strict";cc._RF.push(t,"4310ceORutFCrUEBpToyuTd","spriteCreator");var r,c=(r=null,{createNewLand:function(e){var t=new cc.Node("Land");t.anchorX=0,t.anchorY=0;var n=t.addComponent(cc.Sprite);n.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.color=cc.Color.BLACK,t.height=300,t.width=e;var c=new cc.Node("Red Land");c.anchorY=1;var o=c.addComponent(cc.Sprite);return o.sizeMode=cc.Sprite.SizeMode.CUSTOM,c.color=cc.Color.RED,c.parent=t,c.height=10,c.width=10,c.setPosition(t.width/2,t.height),r?(n.spriteFrame=r,o.spriteFrame=r):cc.loader.loadRes("hero/blank",cc.SpriteFrame,function(e,t){n.spriteFrame=t,o.spriteFrame=t,r=t}),t.center=c,t},createStick:function(e){var t=new cc.Node("stick");t.anchorY=0,t.y=300;var n=t.addComponent(cc.Sprite);return n.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.spriteFrame=r,t.color=cc.Color.BLACK,t.width=e,t.height=0,t}});t.exports=c,cc._RF.pop()},{}],storageManager:[function(e,t,n){"use strict";cc._RF.push(t,"10710Cz8ZRCqLlVtCy4fcaY","storageManager");var c=(cc.sys.localStorage.highestScore||(cc.sys.localStorage.highestScore=0),{getHighestScore:function(){return cc.sys.localStorage.highestScore},setHighestScore:function(e){cc.sys.localStorage.highestScore=e}});t.exports=c,cc._RF.pop()},{}]},{},["backgroundLoader","btn","landMaker","perfectLabel","spriteCreator","storageManager"]);